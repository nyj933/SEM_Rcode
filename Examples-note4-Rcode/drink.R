
library(lavaan)

######## drink12a
lower <- '

           1 
           0.31 1
           0.411 0.232 1
           0.422 0.229 0.324 1
           0.433 0.297 0.39 0.405 1
           0.257 0.274 0.206 0.222 0.239 1
           0.197 0.124 0.197 0.253 0.179 0.373 1
           0.343 0.246 0.26 0.299 0.327 0.354 0.304 1

'

name <- paste("X",c(1:8),sep = "")
cormat <- getCov(lower,names=name)

model12a <- '
             Attitude =~ X1+X2+X3+X4+X5
             Norms =~ X6+X7+X8
'
fit12a <- lavaan::cfa(model12a,sample.cov = cormat, sample.nobs = 756,
                      likelihood = "wishart",std.lv=T)
summary(fit12a,rsquare=T)

######## drink15a

#lower13a <- '

#           1 
 #          0.31 1
  #         0.411 0.232 1
   #        0.422 0.229 0.324 1
    #       0.433 0.297 0.39 0.405 1
     #      0.257 0.274 0.206 0.222 0.239 1
      #     0.197 0.124 0.197 0.253 0.179 0.373 1
       #    0.343 0.246 0.26 0.299 0.327 0.354 0.304 1
        #   0.005 0.013 0.031 0.000 0.019 0.012 0.005 0.014 1
         #  0.018 0.004 0.008 0.008 0.013 0.036 0.018 0.000 0.381 1
          # 0.004 0.03 0.015 0.011 0.024 0.019 0.004 0.015 0.317 0.274 1
           #0.027 0.014 0.014 0.019 0.030 0.037 0.032 0.033 0.495 0.257 0.323 1

#'
name13a <- paste("X",c(1:12),sep = "")
cormat13a <- getCov(lower13a,names=name13a)

####### drink15a
lower15a <- '
      1
      0.633 1
      0.362 0.399 1
      0.327 0.361 0.531 1
      0.341 0.379 0.244 0.238 1
      0.209 0.171 0.140 0.160 0.31 1
      0.313 0.243 0.136 0.150 0.411 0.232 1
      0.287 0.246 0.196 0.163 0.422 0.229 0.324 1
      0.297 0.348 0.15 0.208  0.433 0.297 0.39 0.405 1
      0.32 0.251 0.159 0.202 0.257 0.274 0.206 0.222 0.239 1
      0.243 0.253 0.134 0.120 0.197 0.124 0.197 0.253 0.179 0.373 1
      0.248 0.331 0.19 0.122 0.343 0.246 0.26 0.299 0.327 0.354 0.304 1
      0.259 0.252 0.146 0.141 0.005 0.013 0.031 0.000 0.019 0.012 0.005 0.014 1
      0.17 0.171 0.117 0.061 0.018 0.004 0.008 0.008 0.013 0.036 0.018 0.000 0.381 1
      0.092 0.1 0.143 0.061 0.004 0.03 0.015 0.011 0.024 0.019 0.004 0.015 0.317 0.274 1
      0.147 0.197 0.119 0.184 0.027 0.014 0.014 0.019 0.030 0.037 0.032 0.033 0.495 0.257 0.323 1

'
name15a <- c(paste("Y",c(1:4),sep = ""),paste("X",c(1:12),sep = ""))
cormat13a <- getCov(lower15a,names=name15a)

model15a <- '
             Intention =~ Y1 + Y2
             Behavior =~ Y3 + Y4
             Attitude =~ X1 + X2 + X3 + X4 + X5
             Norms =~ X6 + X7 + X8
             Control =~ X9 + X10 + X11 + X12
             
             Intention ~ Attitude + Norms + Control
             Behavior ~ Intention
'
             
fit15a <- lavaan::cfa(model15a,sample.cov = cormat13a, sample.nobs = 756,
                      likelihood = "wishart",std.lv=T)
summary(fit15a,rsquare=T,standardized=TRUE)             
             
             
             
             





